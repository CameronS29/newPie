function ShowCustomerData(){GlobalAjax.Getcustomers(customerid,FillCustomerCallback)}function FillCustomerCallback(n){var i,t;if(n.value==null||n.error!=null)return!1;i=n.value.Tables[0].Rows.length;i>=1&&(t=n.value.Tables[0].Rows[0],SetMyElement("title",escapeNull(t.title,"")),SetMyElement("CompanyName",escapeNull(t.company,"")),SetMyElement("FirstName",escapeNull(t.first_name,"")),SetMyElement("LastName",escapeNull(t.last_name,"")),SetMyElement("MyStreet",escapeNull(t.address1,"")),SetMyElement("MyCity",escapeNull(t.city,"")),SetMyElement("MyState",escapeNull(t.state,"")),SetMyElement("MyZip",escapeNull(t.zip,"")),SetMyElement("MyEmail",escapeNull(t.email,"")),SetMyElement("MyPhone",escapeNull(t.home_phone,"")))}function Validate_customers(){for(var n,t=!0,r=["first_name","last_name","email","password"],i=0;i<r.length;i++)n=document.getElementById(r[i]),val=n.value,val==""?(n.style.backgroundColor="#FFFF00",t=!1):n.style.backgroundColor="";return t||ShowAutoAlert("Form Validation","Please complete hi-lighted fields before saving...","warning",!0),t}function SaveMyAccount(){if(Validate_customers()){var n=GlobalAjax.GetcustomersClass().value;n.customerID=customerid;n.company=GetMyElement("company");n.title=GetMyElement("title");n.first_name=GetMyElement("first_name");n.last_name=GetMyElement("last_name");n.address1=GetMyElement("address1");n.address2=GetMyElement("address2");n.city=GetMyElement("city");n.state=GetMyElement("state");n.zip=GetMyElement("zip");n.email=GetMyElement("email");n.home_phone=GetMyElement("home_phone");n.mobile_phone=GetMyElement("mobile_phone");n.username=GetMyElement("username");n.password=GetMyElement("password");n.create_user=myemail;GlobalAjax.ProcessCustomersOnline(n,SavecustomersCallback)}}function SavecustomersCallback(n){if(n.value==null||n.error!=null)ShowAutoAlert("Save Error",GetResError(n.error)+" - "+n.value,"error",!0);else{var r=n.value,t=r.split("|"),u=t[0],i=t[1];u==0?ShowAutoAlert("Account Saved",i,"success",!0):ShowAutoAlert("Account Save Error",i,"error",!0)}}function New_customers_shipping(){var n=GlobalAjax.Getcustomers_shippingClass().value;SetMyElement("shippingID",n.cust_shipID);SetMyElement("ship_name",escapeNull(n.ship_name,""));SetMyElement("ship_phone",escapeNull(n.ship_phone,""));SetMyElement("ship_address1",escapeNull(n.ship_address1,""));SetMyElement("ship_address2",escapeNull(n.ship_address2,""));SetMyElement("ship_city",escapeNull(n.ship_city,""));SetMyElement("ship_state",escapeNull(n.ship_state,""));SetMyElement("ship_zip",escapeNull(n.ship_zip,""));SetMyHTML("date_row","")}function EditShipping(n){$("#AccountAddressAddForm").modal("show");GlobalAjax.Getcustomers_shipping(n,FillShippingCallback)}function FillShippingCallback(n){var i,t;if(n.value==null||n.error!=null)return!1;i=n.value.Tables[0].Rows.length;i>=1&&(t=n.value.Tables[0].Rows[0],SetMyElement("shippingID",escapeNull(t.cust_shipID,0)),SetMyElement("ship_name",escapeNull(t.ship_name,"")),SetMyElement("ship_address1",escapeNull(t.ship_address1,"")),SetMyElement("ship_address2",escapeNull(t.ship_address2,"")),SetMyElement("ship_city",escapeNull(t.ship_city,"")),SetMyElement("ship_state",escapeNull(t.ship_state,"")),SetMyElement("ship_zip",escapeNull(t.ship_zip,"")),SetMyElement("ship_phone",escapeNull(t.ship_phone,"")),SetMyHTML("date_row","Created: "+t.create_date+":"+escapeNull(t.create_user,"")+" | Modified: "+escapeNull(t.mod_date,"")+":"+escapeNull(t.mod_user,"")))}function RemoveShipping(n){confirm("Are you sure you want to remove this shipping address from your saved shipping list?")&&GlobalAjax.deactivate_shipping(n,ShippingListCallback)}function ShippingListCallback(n){var r;if(n.value==null||n.error!=null)ShowAutoAlert("Save Error",GetResError(n.error)+" - "+n.value,"error",!0);else{var u=n.value,t=u.split("|"),f=t[0],i=t[1];f==0?(ShowAutoAlert("Account Saved",i,"success",!0),r=GlobalAjax.ShippingListGetCheckout(customerid).value(),$("#ShipHistoryList").html(r)):ShowAutoAlert("Account Save Error",i,"error",!0)}}function Validate_customers_shipping(){for(var n,t=!0,r=["ship_name","ship_address1","ship_city","ship_state","ship_phone"],i=0;i<r.length;i++)n=document.getElementById(r[i]),val=n.value,val==""?(n.style.backgroundColor="#FFFF00",t=!1):n.style.backgroundColor="";return t||ShowAutoAlert("Form Validation","Please complete hi-lighted fields before saving...","warning",!0),t}function SaveShipping(){if(Validate_customers_shipping()){var n=GlobalAjax.Getcustomers_shippingClass().value;n.cust_shipID=GetMyElement("shippingID");n.customerID=customerid;n.ship_name=GetMyElement("ship_name");n.ship_phone=GetMyElement("ship_phone");n.ship_address1=GetMyElement("ship_address1");n.ship_city=GetMyElement("ship_city");n.ship_state=GetMyElement("ship_state");n.ship_zip=GetMyElement("ship_zip");n.create_user=username;GlobalAjax.Process_customers_shipping(n,Savecustomers_shippingCallback)}}function Savecustomers_shippingCallback(n){var r;if(n.value==null||n.error!=null)ShowAutoAlert("Save Error",GetResError(n.error)+" - "+n.value,"error",!0);else{var u=n.value,i=u.split("|"),f=i[0],t=i[1];f==0?(t="Shipping address item saved successfully!",ShowAutoAlert("Shippping Saved",t,"success",!0),r=GlobalAjax.ShippingListGetCheckout(customerid).value,$("#ShipHistoryList").html(r),$("#AccountAddressAddForm").modal("hide")):ShowAutoAlert("Shippping Save Error",t,"error",!0)}}function AddAddress(){New_customers_shipping();$("#AccountAddressAddForm").modal("show")}function CheckShippingSelect(n){var t=n.value;ShipType=t;n.checked?t=="shiptobill"?($("#ShippingTable").hide(),$("#ship1").hide(),$("#ship3").hide(),$("#cust_shipID").val(0),$("#ShipTypeSet").val("shiptobill")):t=="pickup"&&($("#ShippingTable").hide(),$("#cust_shipID").val(0),$("#ship2").hide(),$("#ship3").hide(),$("#ShipTypeSet").val("pickup")):($("#ShippingTable").show(),$("#ship1").show(),$("#ship2").show(),$("#ship3").show(),$("#ShipTypeSet").val(""),$(".CustomShipListClass").prop("checked",!1),$("#cust_shipID").val(0))}function SetCustomShipping(n){$("#cust_shipID").val(n);$("#ShipTypeSet").val("custom");$("#ship1").hide();$("#ship2").hide();SetChecked("CustomShipping",!0)}function UpdateShippingInCart(){}function CheckPayType(n){var t=n.value;t=="cc"?($("#pay_cc").show(),$("#pay_paypal").hide(),$("#btnPlaceOrder").show()):t=="paypal"?($("#pay_paypal").show(),$("#pay_cc").hide(),$("#btnPlaceOrder").hide()):($("#pay_cc").show(),$("#pay_paypal").hide(),$("#btnPlaceOrder").show())}function RemoveCartCheckItem(n){confirm("Are you sure you want to remove this item from your cart?")&&GlobalAjax.RemoveProduct(n,RemoveCheckoutItemCallback)}function RemoveCheckoutItemCallback(){var n=Checkout.ProductsCheckout(sessionid).value;$("#ProductOrderList").html(n)}function EditCartCheckItem(n){$("#ProductForm").modal("show");Checkout.GetProduct(n,FillproductsForm)}function FillproductsForm(n){var i,t;if(n.value==null||n.error!=null)return!1;i=n.value.Tables[0].Rows.length;i>=1&&(t=n.value.Tables[0].Rows[0],LoadTempProductDetail(t.productID),SetMyElement("quantity",escapeNull(t.qty,1)),SetMyElement("ProductPricingID",escapeNull(t.pricingID,"0")),SetMyElement("temp_cartID",escapeNull(t.cart_tempID,"0")))}function LoadTempProductDetail(n){var t=Checkout.LoadProduct(n).value;$("#ProductCartEditForm").html(t)}function CancelUpdate(){$("#ProductForm").modal("hide")}function UpdateMyCart(){var n=$("#temp_cartID").val(),t=$("#quantity").val(),i=$("#ProductPricingID").val();Checkout.SaveCartUpdate(n,t,i,SaveProductUpdateCallback)}function SaveProductUpdateCallback(n){if(n.value==null||n.error!=null)ShowAutoAlert("Save Error",GetResError(n.error)+" - "+n.value,"error",!0);else{var r=n.value,i=r.split("|"),u=i[0],t=i[1];u==0?(t="Cart item saved successfully!",ShowAutoAlert("Cart Updated",t,"success",!0),UpdateCartDetails(),$("#ProductForm").modal("hide")):ShowAutoAlert("Cart Save Error",t,"error",!0)}}function UpdateCartDetails(){var n=Checkout.ProductsCheckout(sessionid).value;$("#ProductOrderList").html(n)}function ValidateCheckout(){var i=!0,n=[],u=GetMyRadio("payment_method"),f,t,e,r;for(u=="cc"?(f=["CCNumber","CCExpireMonth","CCExpireYear","CCCode"],n=n.concat(f)):u=="paypal"||(i=!1,ShowAutoAlert("Payment Validation","Please select and process a payment method before saving...","warning",!0)),t=0;t<n.length;t++)e=$("#"+n[t]).val(),r=document.getElementById(n[t]),e==""?(r.style.backgroundColor="#FFFF00",i=!1):r.style.backgroundColor="";return i||ShowAutoAlert("Form Validation","Please complete hi-lighted fields before saving...","warning",!0),i}function LoadTab1(){$("#iTab1").tab("show")}function ValidateTab1(){var i=!0,n=[],u=$("#cust_shipID").val(),t,f,r;if(u>0)n=["FirstName","LastName","MyEmail","MyPhone","date_wanted"];else{if(u==0&&$("#ShipTypeSet").val()=="")return ShowAutoAlert("Form Validation","Please select a shipping location first...","warning",!0),!1;n=["FirstName","LastName","MyStreet","MyCity","MyState","MyZip","MyEmail","MyPhone","date_wanted"]}for(t=0;t<n.length;t++)f=$("#"+n[t]).val(),r=document.getElementById(n[t]),f==""?(r.style.backgroundColor="#FFFF00",i=!1):r.style.backgroundColor="";return i||ShowAutoAlert("Billing/Shipping Validation","Please complete hi-lighted fields before saving...","warning",!0),i}function SaveTab1(){if(ValidateTab1()){ShipType=="pickup"?($(".pm_pay").show(),$(".pm_pu").hide()):($(".pm_pay").show(),$(".pm_pu").hide());var n=GlobalAjax.GetcustomersClass().value;n.company=GetMyElement("CompanyName");n.customerID=customerid;n.sessionID=sessionid;n.cust_shipID=GetMyElement("cust_shipID");n.title="";n.first_name=GetMyElement("FirstName");n.last_name=GetMyElement("LastName");n.address1=GetMyElement("MyStreet");n.address2=GetMyElement("MyStreet2");n.city=GetMyElement("MyCity");n.state=GetMyElement("MyState");n.zip=GetMyElement("MyZip");n.email=GetMyElement("MyEmail");n.home_phone=GetMyElement("MyPhone");n.notes=GetMyElement("order_notes")+"\nDate Requested: "+GetMyElement("date_wanted");n.DeliveryMethod=GetMyElement("ShipTypeSet");n.create_user=username;GlobalAjax.ProcessTab1(n,ProcessTab1Callback)}else return!1}function ProcessTab1Callback(n){if(n.value==null||n.error!=null)ShowAutoAlert("Save Error",GetResError(n.error)+" - "+n.value,"error",!0);else{var i=n.value,t=i.split("|"),r=t[0],u=t[1];r==0?($("#iTab2").tab("show"),UpdateCartDetails(),ShowAutoAlert("Details Saved","Billing and shipping details saved successfully!","success",!0)):ShowAutoAlert("Account Save Error",u,"error",!0)}}function CompleteCheckout(){var t,n;if(ValidateCheckout()){t=GetMyRadio("payment_method");switch(t){case"cc":n=Checkout.GetEFTClass().value;n.EFTCCNum=GetMyElement("CCNumber");n.EFTCSV=GetMyElement("CCCode");n.myMonth=GetMyElement("CCExpireMonth");n.myYear=GetMyElement("CCExpireYear");n.InvoiceRef=sessionid;n.username=username;n.PayBatch=sessionid;Checkout.ValidateSubmitCreditCardProcess(n,CompleteCheckoutCallback);break;case"pickup":Checkout.FinalOrderSubmit(sessionid,t,CompleteCheckoutPickupCallback)}}}function CompleteCheckoutCallback(n){if(n.value==null||n.error!=null)ShowAutoAlert("Order Process Error",GetResError(n.error)+" - "+n.value,"error",!0);else{var i=n.value,t=i.split("|"),r=t[0],u=t[1],f=t[2];r==0?(showFinalCheckout(f),ShowAutoAlert("Order Confirmed","Your order has been confirmed and we are busy getting it ready.","success",!0)):ShowAutoAlert("Account Checkout Error",u,"error",!0)}}function CompleteCheckoutPickupCallback(n){if(n.value==null||n.error!=null)ShowAutoAlert("Order Process Error",GetResError(n.error)+" - "+n.value,"error",!0);else{var r=n.value,t=r.split("|"),u=t[0],i=t[1];u==0?(showFinalCheckout(i),ShowAutoAlert("Order Confirmed","Your order has been confirmed and we are busy getting it ready.","success",!0)):ShowAutoAlert("Account Checkout Error",i,"error",!0)}}function showFinalCheckout(n){var t=Checkout.BuildCartItem(n).value;SetMyHTML("ProdCheckoutForm",t)}$(document).ready(function(){ShowCustomerData();$("#date_wanted").datepicker({autoclose:!0,clearBtn:!0})});var ShipType="";